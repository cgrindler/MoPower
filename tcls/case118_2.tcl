
source omc.tcl
if {![file exists case118_2.fmu]} {
puts "(1) Processing FMI: Compiling FMU"
compileFMU case118_2.mo
} else { puts "(1) Processing FMI: Model already compiled" }
load ../lib/libomu.so
prg_name DTOpt
mdl_path case118_2.fmu
prg_K $::env(HORIZONT)
prg_t0 {0}
prg_setup_stages
set dt {}
set us {}
set ts {}

sqp_eps 1e-2
sqp_qp_solver Mehrotra
qp_mat_solver $::env(QP_MAT_SOLVER)

mdl_u_active {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1}

mdl_y_min {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.8835999999999999 0.0 -0.05 0.0 -3.0 0.0 -0.13 0.0 -3.0 0.0 -1.47 0.0 -0.35 0.0 -0.1 0.0 -0.16 0.0 -0.08 0.0 -3.0 0.0 -0.47 0.0 -10.0 0.0 -3.0 0.0 -3.0 0.0 -0.14 0.0 -0.08 0.0 -0.08 0.0 -3.0 0.0 -3.0 0.0 -1.0 0.0 -0.85 0.0 -3.0 0.0 -0.08 0.0 -0.08 0.0 -0.6 0.0 -1.0 0.0 -0.2 0.0 -0.67 0.0 -0.67 0.0 -3.0 0.0 -0.1 0.0 -1.0 0.0 -1.0 0.0 -0.06 0.0 -0.08 0.0 -0.2 0.0 -1.65 0.0 -0.08 0.0 -1.0 0.0 -2.1 0.0 -3.0 0.0 -1.0 0.0 -0.03 0.0 -1.0 0.0 -0.5 0.0 -0.15 0.0 -0.08 0.0 -0.08 0.0 -2.0 0.0 -0.08 0.0 -1.0 0.0 -1.0 0.0 -1.0 0.0 -10.0 -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf -Inf}
mdl_y_max {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 9801.0 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.1236000000000002 1.0 0.15 1.0 3.0 1.0 0.5 1.0 3.0 5.5 2.0 1.85 1.2 1.0 0.3 1.0 0.5 1.0 0.24 1.0 3.0 3.2 1.4 4.14 10.0 1.0 3.0 1.07 3.0 1.0 0.42 1.0 0.24 1.0 0.24 1.0 3.0 1.0 3.0 1.19 1.0 3.04 2.1 1.48 3.0 1.0 0.23 1.0 0.15 2.55 1.8 2.6 3.0 1.0 0.2 4.91 2.0 4.92 2.0 8.052 3.0 1.0 0.32 1.0 1.0 1.0 1.0 1.0 0.09 1.0 0.23 1.0 0.7 5.77 2.8 1.0 0.23 1.04 10.0 7.07 3.0 1.0 3.0 1.0 1.0 1.0 0.09 1.0 1.0 3.52 1.55 1.4 0.4 1.0 0.23 1.0 0.23 1.0 2.0 1.0 0.23 1.36 10.0 1.0 10.0 1.0 2.0 1.0 10.0 Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf}
mdl_y_weight1 {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 20.0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 20.0 0 40.0 0 20.0 0 40.0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 20.0 0 20.0 0 40.0 0 40.0 0 20.0 0 20.0 0 40.0 0 20.0 0 20.0 0 20.0 0 40.0 0 40.0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 40.0 0 20.0 0 20.0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 20.0 0 40.0 0 40.0 0 40.0 0 40.0 0 20.0 0 40.0 0 40.0 0 40.0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
mdl_y_weight2 {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01 0 0.01 0 0.01 0 0.01 0 0.0222222 0 0.117647 0 0.01 0 0.01 0 0.01 0 0.01 0 0.0454545 0 0.0318471 0 0.01 0 1.42857 0 0.01 0 0.01 0 0.01 0 0.01 0 0.01 0 0.526316 0 0.0490196 0 0.208333 0 0.01 0 0.01 0 0.0645161 0 0.0625 0 0.01 0 0.0255754 0 0.0255102 0 0.0193648 0 0.01 0 0.01 0 0.01 0 0.01 0 0.01 0 0.01 0 0.0209644 0 0.01 0 2.5 0 0.0164745 0 0.01 0 0.01 0 0.01 0 0.01 0 0.0396825 0 0.25 0 0.01 0 0.01 0 0.01 0 0.01 0 0.277778 0 0.01 0 0.01 0 0.01 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
mdl_y_nominal {1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1}

puts "(2) Solving Problem:"
puts "\n********************************************************************************\n"
prg_setup

proc iterateOpt {} {
prg_simulate
sqp_init
for {set iter 1} {$iter <= 200} {incr iter} {
sqp_max_iters $iter
catch hqp_solve result
if {$result != "iters"} break
}
return $result
}

set timespec [time {set result [iterateOpt]}]
puts "
(3) Solution:"
puts "\n********************************************************************************\n"
puts "			        Run Time: [expr [lindex $timespec 0]/1000] ms"
puts "\n********************************************************************************\n"
puts "Result   : $result" 
puts "Objective: [prg_f]"


